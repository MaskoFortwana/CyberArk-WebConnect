# Task ID: 13
# Title: Update Configuration and Build Scripts for WebConnect Renaming
# Status: done
# Dependencies: 12
# Priority: high
# Description: Update all PowerShell scripts (.ps1 files), batch files (.bat), build configurations, deployment scripts, and environment setup scripts to replace ChromeConnect references with WebConnect and update all paths and executable names.
# Details:
1. Identify all script and configuration files:
   - PowerShell scripts (.ps1)
   - Batch files (.bat)
   - Build configuration files (.props, .targets)
   - Deployment scripts
   - Environment setup scripts
   - CI/CD pipeline configurations

2. Create a comprehensive inventory of files to modify:
   ```powershell
   $scriptFiles = Get-ChildItem -Path . -Include *.ps1,*.bat,*.props,*.targets,*.yml,*.yaml -Recurse -File
   $scriptFiles | Where-Object { (Get-Content $_.FullName) -match "ChromeConnect" } | Select-Object FullName | Export-Csv -Path "files_to_update.csv" -NoTypeInformation
   ```

3. Update PowerShell scripts (.ps1):
   - Replace all instances of "ChromeConnect" with "WebConnect"
   - Update path references (e.g., `C:\Program Files (x86)\CyberArk\PSM\Components\ChromeConnect` to `C:\Program Files (x86)\CyberArk\PSM\Components\WebConnect`)
   - Update executable references (e.g., `ChromeConnect.exe` to `WebConnect.exe`)
   - Update any environment variable references (e.g., `$env:DOTNET_BUNDLE_EXTRACT_BASE_DIR = '...\ChromeConnect'` to `$env:DOTNET_BUNDLE_EXTRACT_BASE_DIR = '...\WebConnect'`)

4. Update batch files (.bat):
   - Replace all instances of "ChromeConnect" with "WebConnect"
   - Update path references and executable names
   - Check for any hardcoded paths that might need updating

5. Update build configuration files:
   - Modify .props files to update project references
   - Update .targets files to reflect new project structure
   - Update any MSBuild properties or targets that reference ChromeConnect

6. Update deployment scripts:
   - Update deployment paths
   - Update file and directory references
   - Ensure all deployment targets are updated to reflect the new naming convention

7. Update environment setup scripts:
   - Update any scripts that set environment variables
   - Update installation or setup scripts
   - Update uninstallation scripts if applicable

8. Update CI/CD pipeline configurations:
   - Update GitHub Actions workflows or Azure DevOps pipeline definitions
   - Update build agent configurations
   - Update deployment target configurations

9. Special considerations:
   - Use regex patterns for complex replacements
   - Be cautious with partial word matches (e.g., ensure "ChromeConnector" doesn't become "WebConnector")
   - Preserve case sensitivity where appropriate
   - Maintain script formatting and comments

10. Example PowerShell script for bulk updates:
    ```powershell
    $files = Get-Content "files_to_update.csv" | ConvertFrom-Csv
    foreach ($file in $files) {
        $content = Get-Content $file.FullName -Raw
        $updatedContent = $content -replace "ChromeConnect", "WebConnect"
        $updatedContent = $updatedContent -replace "C:\\Program Files \(x86\)\\CyberArk\\PSM\\Components\\ChromeConnect", "C:\\Program Files (x86)\\CyberArk\\PSM\\Components\\WebConnect"
        Set-Content -Path $file.FullName -Value $updatedContent
        Write-Host "Updated: $($file.FullName)"
    }
    ```

11. Document all changes made:
    - Create a log of all modified files
    - Document any special cases or exceptions
    - Note any files that required manual intervention

# Test Strategy:
1. Automated verification:
   - Create a PowerShell script to scan all updated files and verify no "ChromeConnect" references remain:
     ```powershell
     $scriptFiles = Get-ChildItem -Path . -Include *.ps1,*.bat,*.props,*.targets,*.yml,*.yaml -Recurse -File
     $remainingReferences = $scriptFiles | Where-Object { (Get-Content $_.FullName) -match "ChromeConnect" } | Select-Object FullName
     if ($remainingReferences) {
         Write-Error "ChromeConnect references still exist in the following files:"
         $remainingReferences | ForEach-Object { Write-Error $_.FullName }
         exit 1
     } else {
         Write-Host "All ChromeConnect references successfully updated to WebConnect"
     }
     ```

2. Manual testing of critical scripts:
   - Execute each critical PowerShell and batch script in a test environment
   - Verify they run without errors
   - Check logs for any unexpected behavior
   - Confirm all paths are correctly resolved

3. Build verification:
   - Run a complete build using the updated build scripts
   - Verify the build completes successfully
   - Check that all artifacts are generated with correct naming

4. Deployment testing:
   - Perform a test deployment to a staging environment
   - Verify all components are deployed to the correct locations
   - Confirm the application starts and runs correctly
   - Verify environment variables are set correctly

5. Integration testing:
   - Test the application's functionality after deployment
   - Verify all components can communicate with each other
   - Test any external integrations that might be affected by path changes

6. Rollback testing:
   - Create a rollback plan
   - Test the rollback procedure to ensure it works correctly
   - Document any issues encountered during rollback

7. Documentation review:
   - Review all documentation to ensure it reflects the new naming convention
   - Update any screenshots or diagrams that show file paths or script names

8. Create a test report:
   - Document all tests performed
   - Note any issues encountered and their resolutions
   - Provide recommendations for any further improvements

# Subtasks:
## 1. Update PowerShell Scripts [done]
### Dependencies: None
### Description: Update all PowerShell (.ps1) scripts to replace ChromeConnect references with WebConnect
### Details:
- Update publish.ps1 with new executable names and paths
- Update deploy.ps1 with new target directories and executable names
- Update Test-BuildAndExtraction.ps1 and Validate-FinalIntegration.ps1
- Update all scripts in scripts/ directory
- Update environment variable paths (C:\ChromeConnect → C:\WebConnect)
- Update temp directory paths (%TEMP%\ChromeConnect\ → %TEMP%\WebConnect\)

## 2. Update Batch Files [done]
### Dependencies: 13.1
### Description: Update all batch (.bat) files to use WebConnect naming
### Details:
- Update deploy.bat with new executable name (ChromeConnect.exe → WebConnect.exe)
- Update publish.bat with new build targets
- Update target directory paths (C:\ChromeConnect → C:\WebConnect)
- Update all executable references and file paths
<info added on 2025-05-29T16:10:28.845Z>
Batch files review completed. Both deploy.bat and publish.bat have been verified to already contain correct WebConnect references:

- deploy.bat correctly references WebConnect.exe, proper target directories (C:\WebConnect), and contains updated branding in help text
- publish.bat correctly references src\WebConnect project paths and outputs WebConnect.exe with proper branding

No ChromeConnect references were found in any batch files during grep search. All batch files are properly updated for WebConnect rebranding. No further changes needed.
</info added on 2025-05-29T16:10:28.845Z>

## 3. Update Configuration Files [done]
### Dependencies: 13.2
### Description: Update configuration files like appsettings.json and test-config.json
### Details:
- Update appsettings.json for any ChromeConnect references
- Update test-config.json with new application name
- Update any other JSON or XML configuration files
- Update logging configuration with new application name
<info added on 2025-05-29T16:11:36.356Z>
Configuration files update completed successfully:

**Files Updated:**

1. **test-config.json:**
   - Updated description: "ChromeConnect Build and Extraction Test Configuration" → "WebConnect Build and Extraction Test Configuration"
   - Updated extractionPath: "...\\ChromeConnect" → "...\\WebConnect" 
   - Updated requiredFiles paths: "./src/ChromeConnect/..." → "./src/WebConnect/..."

2. **appsettings.json:**
   - Updated log file path: "logs/chromeconnect-.log" → "logs/webconnect-.log"
   - Updated configuration section: "ChromeConnect" → "WebConnect"
   - All nested browser, logging, and error handling settings now under "WebConnect" section

**Verification:**
- Conducted searches for ChromeConnect references in XML, config, YAML files - none found
- Final verification shows no remaining ChromeConnect references in any JSON files
- All configuration files now properly use WebConnect branding and paths

**Status:** All configuration files successfully updated for WebConnect rebranding.
</info added on 2025-05-29T16:11:36.356Z>

## 4. Update Environment Paths [done]
### Dependencies: 13.3
### Description: Update all environment variable paths and deployment directories
### Details:
- Update PSM deployment path: C:\Program Files (x86)\CyberArk\PSM\Components\ChromeConnect → WebConnect
- Update corporate deployment paths: C:\Program Files\ChromeConnect → WebConnect
- Update temp extraction paths: %TEMP%\ChromeConnect\ → %TEMP%\WebConnect\
- Update log file naming patterns: chromeconnect-YYYYMMDD.log → webconnect-YYYYMMDD.log
<info added on 2025-05-29T16:21:10.100Z>
Environment paths update completed successfully!

**Files Updated:**

1. **README.md** - Updated all ChromeConnect references to WebConnect including:
   - Application name and branding
   - Executable names (ChromeConnect.exe → WebConnect.exe)
   - Installation paths (C:\ChromeConnect → C:\WebConnect)
   - Log directory paths (%TEMP%\ChromeConnect\ → %TEMP%\WebConnect\)
   - Screenshot paths
   - GitHub URLs and repository references

2. **TESTING.md** - Updated:
   - Document title and references
   - Package restore paths (src\ChromeConnect → src\WebConnect)
   - ACL check paths

3. **scripts/README-EnvironmentSetup.md** - Updated:
   - Application name and references
   - Environment variable paths (.NET\CHROMECONNECT\ → .NET\WEBCONNECT\)
   - Target extraction directory (Components\ChromeConnect\ → Components\WebConnect\)
   - AppLocker rule references
   - All executable references

4. **Final-Integration-Report.md** - Updated:
   - Report title and all application references
   - Target directories and environment variables
   - Executable names and ZIP package names
   - Version information displays

5. **scripts/prd.txt** - Updated:
   - PRD title and problem statements
   - Application name and extraction paths
   - Environment variable configurations

6. **publish/README.md** - Updated:
   - Complete rebranding to WebConnect
   - All paths, URLs, and executable references

7. **docs/Script-Changes-Changelog.md** - Updated:
   - Document title
   - Extraction base path reference
   - File structure references

**Additional Environment Variable Path Updated:**
- .NET extraction: .NET\CHROMECONNECT\ → .NET\WEBCONNECT\

**Status:** All environment paths and deployment directory references successfully updated for WebConnect rebranding.
</info added on 2025-05-29T16:21:10.100Z>

