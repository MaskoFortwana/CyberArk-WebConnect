# Task ID: 19
# Title: Add cyb-deploy Directory to WebConnect Zip Package
# Status: done
# Dependencies: 2, 13, 15, 18
# Priority: high
# Description: Modify the publish.ps1 script to include the cyb-deploy directory containing CyberArk connection component files in the WebConnect 1.0.1 deployment package.
# Details:
1. Create a new 'cyb-deploy' directory in the project root if it doesn't already exist.

2. Ensure the following CyberArk connection component files are placed in the cyb-deploy directory:
   - CC-WebConnect.zip
   - CC-WebConnect.xml
   - WebConnect-Wrapper.exe
   - WebConnect-Wrapper.au3

3. Modify the publish.ps1 script to include the cyb-deploy directory contents in the final zip package:
   ```powershell
   # Add section to copy cyb-deploy files to the root of the zip package
   Write-Host "Adding CyberArk connection component files to package..."
   
   # Define source and destination paths
   $cybDeploySourceDir = Join-Path $PSScriptRoot "cyb-deploy"
   
   # Verify cyb-deploy directory exists
   if (-not (Test-Path $cybDeploySourceDir)) {
       Write-Error "cyb-deploy directory not found at $cybDeploySourceDir"
       exit 1
   }
   
   # Copy all files from cyb-deploy to the root of the zip package
   Get-ChildItem -Path $cybDeploySourceDir -File | ForEach-Object {
       $destPath = Join-Path $publishDir $_.Name
       Copy-Item -Path $_.FullName -Destination $destPath -Force
       Write-Host "  Added $($_.Name) to package root"
   }
   ```

4. Update the version number in the appropriate configuration files to 1.0.1:
   - Update version in .csproj file
   - Update version in AssemblyInfo.cs if present
   - Update version in any other relevant configuration files

5. Ensure the README.md or documentation is updated to mention the inclusion of these CyberArk connection component files in the deployment package.

6. Verify that the existing zip packaging logic in publish.ps1 will correctly include these new files in the root of the zip alongside the publish directory structure.

7. If necessary, update any file manifest or verification checksums that might be included in the deployment process.

# Test Strategy:
1. Run the modified publish.ps1 script to generate the WebConnect 1.0.1 deployment package.

2. Extract the generated zip package to a temporary location and verify:
   - CC-WebConnect.zip exists in the root of the extracted package
   - CC-WebConnect.xml exists in the root of the extracted package
   - WebConnect-Wrapper.exe exists in the root of the extracted package
   - WebConnect-Wrapper.au3 exists in the root of the extracted package
   - The existing publish directory structure is still intact and complete

3. Perform a diff comparison between the previous package structure and the new one to ensure only the intended files were added.

4. Verify the version number is correctly set to 1.0.1 in all relevant files.

5. Test the deployment package in a CyberArk PSM environment:
   - Deploy the package according to standard procedures
   - Verify the CyberArk connection component can locate and use the included files
   - Test the connection component functionality with the WebConnect application

6. Run a validation script that checks for the presence of all required files in the package:
   ```powershell
   $requiredFiles = @(
       "CC-WebConnect.zip",
       "CC-WebConnect.xml", 
       "WebConnect-Wrapper.exe",
       "WebConnect-Wrapper.au3"
   )
   
   $missingFiles = $requiredFiles | Where-Object { -not (Test-Path (Join-Path $extractPath $_)) }
   if ($missingFiles.Count -gt 0) {
       Write-Error "Missing required files in package: $($missingFiles -join ', ')"
       exit 1
   }
   ```
